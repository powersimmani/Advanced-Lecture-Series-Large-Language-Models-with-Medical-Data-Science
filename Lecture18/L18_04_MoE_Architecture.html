<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MoE Architecture</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Aptos, 'Segoe UI', sans-serif;
            background: white;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        
        .container {
            width: 960px;
            height: 540px;
            padding: 35px 45px;
            background: white;
        }
        
        .title {
            font-size: 20px;
            font-weight: 600;
            color: #1E64C8;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .diagram-container {
            display: flex;
            justify-content: center;
            margin-bottom: 15px;
        }
        
        .info-box {
            background: #f0f5fc;
            border: 2px solid #1E64C8;
            border-radius: 8px;
            padding: 12px 20px;
        }
        
        .info-title {
            font-size: 16px;
            font-weight: 700;
            color: #1E64C8;
            margin-bottom: 6px;
        }
        
        .info-text {
            font-size: 14px;
            color: #333;
            line-height: 1.4;
        }
        
        .expert-box {
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .expert-box:hover {
            transform: scale(1.05);
        }
        
        .gating-box {
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .gating-box:hover {
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="title">Mixture of Experts (MoE) Architecture & Gating Mechanism</div>
        
        <div class="diagram-container">
            <svg width="870" height="410" viewBox="0 0 870 410" xmlns="http://www.w3.org/2000/svg">
                <!-- Input Layer -->
                <rect x="310" y="10" width="250" height="50" rx="8" fill="#ffffff" stroke="#1E64C8" stroke-width="2.5"/>
                <text x="435" y="32" text-anchor="middle" font-family="Aptos, 'Segoe UI', sans-serif" font-size="16" font-weight="600" fill="#1E64C8">Medical Data</text>
                <text x="435" y="48" text-anchor="middle" font-family="Aptos, 'Segoe UI', sans-serif" font-size="13" fill="#666">Images, Text, Records</text>
                
                <!-- Icon for input -->
                <circle cx="330" cy="35" r="8" fill="#1E64C8" opacity="0.3"/>
                <circle cx="350" cy="35" r="8" fill="#1E64C8" opacity="0.3"/>
                <circle cx="370" cy="35" r="8" fill="#1E64C8" opacity="0.3"/>
                
                <!-- Arrow 1 -->
                <path d="M 435 60 L 435 90" stroke="#1E64C8" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
                
                <!-- Gating Network -->
                <g class="gating-box">
                    <rect x="310" y="90" width="250" height="60" rx="8" fill="#fff3cd" stroke="#ffc107" stroke-width="2.5"/>
                    <text x="435" y="115" text-anchor="middle" font-family="Aptos, 'Segoe UI', sans-serif" font-size="16" font-weight="600" fill="#856404">Gating Network (Router)</text>
                    <text x="435" y="133" text-anchor="middle" font-family="Aptos, 'Segoe UI', sans-serif" font-size="13" fill="#856404">Selects Top-K Experts</text>
                    
                    <!-- Router icon -->
                    <path d="M 325 120 L 335 125 L 325 130 M 330 125 L 320 125" stroke="#856404" stroke-width="2" fill="none"/>
                    <circle cx="545" cy="125" r="6" fill="none" stroke="#856404" stroke-width="2"/>
                    <path d="M 540 125 L 535 120 M 540 125 L 535 130" stroke="#856404" stroke-width="2" fill="none"/>
                </g>
                
                <!-- Routing weights visualization -->
                <text x="435" y="145" text-anchor="middle" font-family="Aptos, 'Segoe UI', sans-serif" font-size="11" fill="#856404" opacity="0.8">w‚ÇÅ=0.7  w‚ÇÖ=0.3</text>
                
                <!-- Arrows to experts (highlighting expert 1 and 5) -->
                <path d="M 380 150 L 120 195" stroke="#28a745" stroke-width="3" fill="none" opacity="0.7" marker-end="url(#arrowhead-green)"/>
                <path d="M 490 150 L 540 195" stroke="#28a745" stroke-width="3" fill="none" opacity="0.7" marker-end="url(#arrowhead-green)"/>
                
                <!-- Expert Layer Grid -->
                <g class="expert-box">
                    <!-- Row 1 -->
                    <rect x="30" y="195" width="100" height="55" rx="6" fill="#d4edda" stroke="#28a745" stroke-width="2.5"/>
                    <text x="80" y="217" text-anchor="middle" font-family="Aptos, 'Segoe UI', sans-serif" font-size="13" font-weight="600" fill="#155724">Expert 1</text>
                    <text x="80" y="233" text-anchor="middle" font-family="Aptos, 'Segoe UI', sans-serif" font-size="12" fill="#155724">Radiology</text>
                    <circle cx="115" cy="222" r="4" fill="#28a745"/>
                </g>
                
                <g class="expert-box">
                    <rect x="150" y="195" width="100" height="55" rx="6" fill="#e8f4fd" stroke="#1E64C8" stroke-width="2"/>
                    <text x="200" y="217" text-anchor="middle" font-family="Aptos, 'Segoe UI', sans-serif" font-size="13" font-weight="600" fill="#1E64C8">Expert 2</text>
                    <text x="200" y="233" text-anchor="middle" font-family="Aptos, 'Segoe UI', sans-serif" font-size="12" fill="#1E64C8">Pathology</text>
                </g>
                
                <g class="expert-box">
                    <rect x="270" y="195" width="100" height="55" rx="6" fill="#e8f4fd" stroke="#1E64C8" stroke-width="2"/>
                    <text x="320" y="217" text-anchor="middle" font-family="Aptos, 'Segoe UI', sans-serif" font-size="13" font-weight="600" fill="#1E64C8">Expert 3</text>
                    <text x="320" y="233" text-anchor="middle" font-family="Aptos, 'Segoe UI', sans-serif" font-size="12" fill="#1E64C8">Cardiology</text>
                </g>
                
                <g class="expert-box">
                    <rect x="390" y="195" width="100" height="55" rx="6" fill="#e8f4fd" stroke="#1E64C8" stroke-width="2"/>
                    <text x="440" y="217" text-anchor="middle" font-family="Aptos, 'Segoe UI', sans-serif" font-size="13" font-weight="600" fill="#1E64C8">Expert 4</text>
                    <text x="440" y="233" text-anchor="middle" font-family="Aptos, 'Segoe UI', sans-serif" font-size="12" fill="#1E64C8">Neurology</text>
                </g>
                
                <!-- Row 2 -->
                <g class="expert-box">
                    <rect x="510" y="195" width="100" height="55" rx="6" fill="#d4edda" stroke="#28a745" stroke-width="2.5"/>
                    <text x="560" y="217" text-anchor="middle" font-family="Aptos, 'Segoe UI', sans-serif" font-size="13" font-weight="600" fill="#155724">Expert 5</text>
                    <text x="560" y="233" text-anchor="middle" font-family="Aptos, 'Segoe UI', sans-serif" font-size="12" fill="#155724">Oncology</text>
                    <circle cx="595" cy="222" r="4" fill="#28a745"/>
                </g>
                
                <g class="expert-box">
                    <rect x="630" y="195" width="100" height="55" rx="6" fill="#e8f4fd" stroke="#1E64C8" stroke-width="2"/>
                    <text x="680" y="217" text-anchor="middle" font-family="Aptos, 'Segoe UI', sans-serif" font-size="13" font-weight="600" fill="#1E64C8">Expert 6</text>
                    <text x="680" y="233" text-anchor="middle" font-family="Aptos, 'Segoe UI', sans-serif" font-size="12" fill="#1E64C8">Genomics</text>
                </g>
                
                <g class="expert-box">
                    <rect x="750" y="195" width="100" height="55" rx="6" fill="#e8f4fd" stroke="#1E64C8" stroke-width="2"/>
                    <text x="800" y="217" text-anchor="middle" font-family="Aptos, 'Segoe UI', sans-serif" font-size="13" font-weight="600" fill="#1E64C8">Expert 7</text>
                    <text x="800" y="233" text-anchor="middle" font-family="Aptos, 'Segoe UI', sans-serif" font-size="12" fill="#1E64C8">Surgery</text>
                </g>
                
                <g class="expert-box">
                    <rect x="30" y="270" width="100" height="55" rx="6" fill="#e8f4fd" stroke="#1E64C8" stroke-width="2"/>
                    <text x="80" y="292" text-anchor="middle" font-family="Aptos, 'Segoe UI', sans-serif" font-size="13" font-weight="600" fill="#1E64C8">Expert 8</text>
                    <text x="80" y="308" text-anchor="middle" font-family="Aptos, 'Segoe UI', sans-serif" font-size="12" fill="#1E64C8">General</text>
                </g>
                
                <!-- Legend for inactive experts -->
                <text x="200" y="295" font-family="Aptos, 'Segoe UI', sans-serif" font-size="12" fill="#666">Inactive (0 computation)</text>
                
                <!-- Arrows from active experts to output -->
                <path d="M 80 250 L 380 335" stroke="#28a745" stroke-width="2.5" fill="none" opacity="0.7"/>
                <path d="M 560 250 L 490 335" stroke="#28a745" stroke-width="2.5" fill="none" opacity="0.7"/>
                
                <!-- Output Layer -->
                <rect x="310" y="335" width="250" height="55" rx="8" fill="#ffffff" stroke="#1E64C8" stroke-width="2.5"/>
                <text x="435" y="357" text-anchor="middle" font-family="Aptos, 'Segoe UI', sans-serif" font-size="16" font-weight="600" fill="#1E64C8">Aggregated Result</text>
                <text x="435" y="375" text-anchor="middle" font-family="Aptos, 'Segoe UI', sans-serif" font-size="13" fill="#666">Weighted Combination: 0.7√óE‚ÇÅ + 0.3√óE‚ÇÖ</text>
                
                <!-- Arrow markers -->
                <defs>
                    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#1E64C8"/>
                    </marker>
                    <marker id="arrowhead-green" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#28a745"/>
                    </marker>
                </defs>
            </svg>
        </div>
        
        <div class="info-box">
            <div class="info-title">üéØ Key Concept: Sparse Activation</div>
            <div class="info-text">
                Only 2-4 experts are activated per input, enabling massive scale with manageable computation. 
                Gating network learns to route inputs to the most relevant domain specialists. <strong>Green highlights show active experts</strong> processing this input.
            </div>
        </div>
    </div>
</body>
</html>